import{a as E,b as B}from"./chunk.XPFMMO3L.js";var R=(function(){"use strict";let v=()=>{},M={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:v,afterNodeAdded:v,beforeNodeMorphed:v,afterNodeMorphed:v,beforeNodeRemoved:v,afterNodeRemoved:v,beforeAttributeUpdated:v},head:{style:"merge",shouldPreserve:f=>f.getAttribute("im-preserve")==="true",shouldReAppend:f=>f.getAttribute("im-re-append")==="true",shouldRemove:v,afterHeadMorphed:v},restoreFocus:!0};function k(f,m,c={}){f=O(f);let p=N(m),h=V(f,p,c),l=H(h,()=>L(h,f,p,r=>r.morphStyle==="innerHTML"?(S(r,f,p),Array.from(f.childNodes)):b(r,f,p)));return h.pantry.remove(),l}function b(f,m,c){let p=N(m);return S(f,p,c,m,m.nextSibling),Array.from(p.childNodes)}function H(f,m){var s;if(!f.config.restoreFocus)return m();let c=document.activeElement;if(!(c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement))return m();let{id:p,selectionStart:h,selectionEnd:l}=c,r=m();return p&&p!==((s=document.activeElement)==null?void 0:s.getAttribute("id"))&&(c=f.target.querySelector(`[id="${p}"]`),c==null||c.focus()),c&&!c.selectionEnd&&l&&c.setSelectionRange(h,l),r}let S=(function(){function f(e,t,i,n=null,o=null){t instanceof HTMLTemplateElement&&i instanceof HTMLTemplateElement&&(t=t.content,i=i.content),n||(n=t.firstChild);for(let a of i.childNodes){if(n&&n!=o){let d=c(e,a,n,o);if(d){d!==n&&h(e,n,d),y(d,a,e),n=d.nextSibling;continue}}if(a instanceof Element){let d=a.getAttribute("id");if(e.persistentIds.has(d)){let g=l(t,d,n,e);y(g,a,e),n=g.nextSibling;continue}}let u=m(t,a,n,e);u&&(n=u.nextSibling)}for(;n&&n!=o;){let a=n;n=n.nextSibling,p(e,a)}}function m(e,t,i,n){if(n.callbacks.beforeNodeAdded(t)===!1)return null;if(n.idMap.has(t)){let o=document.createElement(t.tagName);return e.insertBefore(o,i),y(o,t,n),n.callbacks.afterNodeAdded(o),o}else{let o=document.importNode(t,!0);return e.insertBefore(o,i),n.callbacks.afterNodeAdded(o),o}}let c=(function(){function e(n,o,a,u){let d=null,g=o.nextSibling,T=0,A=a;for(;A&&A!=u;){if(i(A,o)){if(t(n,A,o))return A;d===null&&(n.idMap.has(A)||(d=A))}if(d===null&&g&&i(A,g)&&(T++,g=g.nextSibling,T>=2&&(d=void 0)),n.activeElementAndParents.includes(A))break;A=A.nextSibling}return d||null}function t(n,o,a){let u=n.idMap.get(o),d=n.idMap.get(a);if(!d||!u)return!1;for(let g of u)if(d.has(g))return!0;return!1}function i(n,o){var d,g,T;let a=n,u=o;return a.nodeType===u.nodeType&&a.tagName===u.tagName&&(!((d=a.getAttribute)!=null&&d.call(a,"id"))||((g=a.getAttribute)==null?void 0:g.call(a,"id"))===((T=u.getAttribute)==null?void 0:T.call(u,"id")))}return e})();function p(e,t){var i;if(e.idMap.has(t))s(e.pantry,t,null);else{if(e.callbacks.beforeNodeRemoved(t)===!1)return;(i=t.parentNode)==null||i.removeChild(t),e.callbacks.afterNodeRemoved(t)}}function h(e,t,i){let n=t;for(;n&&n!==i;){let o=n;n=n.nextSibling,p(e,o)}return n}function l(e,t,i,n){var a,u;let o=((u=(a=n.target).getAttribute)==null?void 0:u.call(a,"id"))===t&&n.target||n.target.querySelector(`[id="${t}"]`)||n.pantry.querySelector(`[id="${t}"]`);return r(o,n),s(e,o,i),o}function r(e,t){let i=e.getAttribute("id");for(;e=e.parentNode;){let n=t.idMap.get(e);n&&(n.delete(i),n.size||t.idMap.delete(e))}}function s(e,t,i){if(e.moveBefore)try{e.moveBefore(t,i)}catch(n){e.insertBefore(t,i)}else e.insertBefore(t,i)}return f})(),y=(function(){function f(r,s,e){return e.ignoreActive&&r===document.activeElement?null:(e.callbacks.beforeNodeMorphed(r,s)===!1||(r instanceof HTMLHeadElement&&e.head.ignore||(r instanceof HTMLHeadElement&&e.head.style!=="morph"?I(r,s,e):(m(r,s,e),l(r,e)||S(e,r,s))),e.callbacks.afterNodeMorphed(r,s)),r)}function m(r,s,e){let t=s.nodeType;if(t===1){let i=r,n=s,o=i.attributes,a=n.attributes;for(let u of a)h(u.name,i,"update",e)||i.getAttribute(u.name)!==u.value&&i.setAttribute(u.name,u.value);for(let u=o.length-1;0<=u;u--){let d=o[u];if(d&&!n.hasAttribute(d.name)){if(h(d.name,i,"remove",e))continue;i.removeAttribute(d.name)}}l(i,e)||c(i,n,e)}(t===8||t===3)&&r.nodeValue!==s.nodeValue&&(r.nodeValue=s.nodeValue)}function c(r,s,e){if(r instanceof HTMLInputElement&&s instanceof HTMLInputElement&&s.type!=="file"){let t=s.value,i=r.value;p(r,s,"checked",e),p(r,s,"disabled",e),s.hasAttribute("value")?i!==t&&(h("value",r,"update",e)||(r.setAttribute("value",t),r.value=t)):h("value",r,"remove",e)||(r.value="",r.removeAttribute("value"))}else if(r instanceof HTMLOptionElement&&s instanceof HTMLOptionElement)p(r,s,"selected",e);else if(r instanceof HTMLTextAreaElement&&s instanceof HTMLTextAreaElement){let t=s.value,i=r.value;if(h("value",r,"update",e))return;t!==i&&(r.value=t),r.firstChild&&r.firstChild.nodeValue!==t&&(r.firstChild.nodeValue=t)}}function p(r,s,e,t){let i=s[e],n=r[e];if(i!==n){let o=h(e,r,"update",t);o||(r[e]=s[e]),i?o||r.setAttribute(e,""):h(e,r,"remove",t)||r.removeAttribute(e)}}function h(r,s,e,t){return r==="value"&&t.ignoreActiveValue&&s===document.activeElement?!0:t.callbacks.beforeAttributeUpdated(r,s,e)===!1}function l(r,s){return!!s.ignoreActiveValue&&r===document.activeElement&&r!==document.body}return f})();function L(f,m,c,p){if(f.head.block){let h=m.querySelector("head"),l=c.querySelector("head");if(h&&l){let r=I(h,l,f);return Promise.all(r).then(()=>{let s=Object.assign(f,{head:{block:!1,ignore:!0}});return p(s)})}}return p(f)}function I(f,m,c){let p=[],h=[],l=[],r=[],s=new Map;for(let t of m.children)s.set(t.outerHTML,t);for(let t of f.children){let i=s.has(t.outerHTML),n=c.head.shouldReAppend(t),o=c.head.shouldPreserve(t);i||o?n?h.push(t):(s.delete(t.outerHTML),l.push(t)):c.head.style==="append"?n&&(h.push(t),r.push(t)):c.head.shouldRemove(t)!==!1&&h.push(t)}r.push(...s.values());let e=[];for(let t of r){let i=document.createRange().createContextualFragment(t.outerHTML).firstChild;if(c.callbacks.beforeNodeAdded(i)!==!1){if("href"in i&&i.href||"src"in i&&i.src){let n,o=new Promise(function(a){n=a});i.addEventListener("load",function(){n()}),e.push(o)}f.appendChild(i),c.callbacks.afterNodeAdded(i),p.push(i)}}for(let t of h)c.callbacks.beforeNodeRemoved(t)!==!1&&(f.removeChild(t),c.callbacks.afterNodeRemoved(t));return c.head.afterHeadMorphed(f,{added:p,kept:l,removed:h}),e}let V=(function(){function f(e,t,i){let{persistentIds:n,idMap:o}=r(e,t),a=m(i),u=a.morphStyle||"outerHTML";if(!["innerHTML","outerHTML"].includes(u))throw`Do not understand how to morph style ${u}`;return{target:e,newContent:t,config:a,morphStyle:u,ignoreActive:a.ignoreActive,ignoreActiveValue:a.ignoreActiveValue,restoreFocus:a.restoreFocus,idMap:o,persistentIds:n,pantry:c(),activeElementAndParents:p(e),callbacks:a.callbacks,head:a.head}}function m(e){let t=Object.assign({},M);return Object.assign(t,e),t.callbacks=Object.assign({},M.callbacks,e.callbacks),t.head=Object.assign({},M.head,e.head),t}function c(){let e=document.createElement("div");return e.hidden=!0,document.body.insertAdjacentElement("afterend",e),e}function p(e){let t=[],i=document.activeElement;if((i==null?void 0:i.tagName)!=="BODY"&&e.contains(i))for(;i&&(t.push(i),i!==e);)i=i.parentElement;return t}function h(e){var i;let t=Array.from(e.querySelectorAll("[id]"));return(i=e.getAttribute)!=null&&i.call(e,"id")&&t.push(e),t}function l(e,t,i,n){for(let o of n){let a=o.getAttribute("id");if(t.has(a)){let u=o;for(;u;){let d=e.get(u);if(d==null&&(d=new Set,e.set(u,d)),d.add(a),u===i)break;u=u.parentElement}}}}function r(e,t){let i=h(e),n=h(t),o=s(i,n),a=new Map;l(a,o,e,i);let u=t.__idiomorphRoot||t;return l(a,o,u,n),{persistentIds:o,idMap:a}}function s(e,t){let i=new Set,n=new Map;for(let{id:a,tagName:u}of e)n.has(a)?i.add(a):n.set(a,u);let o=new Set;for(let{id:a,tagName:u}of t)o.has(a)?i.add(a):n.get(a)===u&&o.add(a);for(let a of i)o.delete(a);return o}return f})(),{normalizeElement:O,normalizeParent:N}=(function(){let f=new WeakSet;function m(l){return l instanceof Document?l.documentElement:l}function c(l){if(l==null)return document.createElement("div");if(typeof l=="string")return c(h(l));if(f.has(l))return l;if(l instanceof Node){if(l.parentNode)return new p(l);{let r=document.createElement("div");return r.append(l),r}}else{let r=document.createElement("div");for(let s of[...l])r.append(s);return r}}class p{constructor(r){this.originalNode=r,this.realParentNode=r.parentNode,this.previousSibling=r.previousSibling,this.nextSibling=r.nextSibling}get childNodes(){let r=[],s=this.previousSibling?this.previousSibling.nextSibling:this.realParentNode.firstChild;for(;s&&s!=this.nextSibling;)r.push(s),s=s.nextSibling;return r}querySelectorAll(r){return this.childNodes.reduce((s,e)=>{if(e instanceof Element){e.matches(r)&&s.push(e);let t=e.querySelectorAll(r);for(let i=0;i<t.length;i++)s.push(t[i])}return s},[])}insertBefore(r,s){return this.realParentNode.insertBefore(r,s)}moveBefore(r,s){return this.realParentNode.moveBefore(r,s)}get __idiomorphRoot(){return this.originalNode}}function h(l){let r=new DOMParser,s=l.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(s.match(/<\/html>/)||s.match(/<\/head>/)||s.match(/<\/body>/)){let e=r.parseFromString(l,"text/html");if(s.match(/<\/html>/))return f.add(e),e;{let t=e.firstChild;return t&&f.add(t),t}}else{let t=r.parseFromString("<body><template>"+l+"</template></body>","text/html").body.querySelector("template").content;return f.add(t),t}}return{normalizeElement:m,normalizeParent:c}})();return{morph:k,defaults:M}})();function D(v,M,k={}){R.morph(v,M,B(E({},k),{callbacks:{beforeNodeMorphed:(b,H)=>{var S,y;((S=b==null?void 0:b.tagName)!=null&&S.startsWith("QUIET-")||(y=b==null?void 0:b.tagName)!=null&&y.startsWith("WA-"))&&[...H.attributes,...b.attributes].forEach(L=>{H.setAttribute(L.name,L.value)})},afterNodeMorphed(b){typeof b.requestUpdate=="function"&&b.requestUpdate()}}}))}export{D as a};
